<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT, Zoey" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="CS | Web | Write | Music">
<meta property="og:type" content="website">
<meta property="og:title" content="Zhuo Han">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Zhuo Han">
<meta property="og:description" content="CS | Web | Write | Music">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zhuo Han">
<meta name="twitter:description" content="CS | Web | Write | Music">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Zoey'
    }
  };
</script>

  <title> Zhuo Han </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-113008849-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?a03836ec239f375669ad8f7cb87ff77c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Zhuo Han</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/26/X6-DP-Knapsack/" itemprop="url">
                  X6_DP & Knapsack
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-26T16:49:03-07:00" content="2018-03-26">
              2018-03-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index">
                    <span itemprop="name">Program</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/26/X6-DP-Knapsack/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/26/X6-DP-Knapsack/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/26/X6-DP-Knapsack/" class="leancloud_visitors" data-flag-title="X6_DP & Knapsack">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h5><ul>
<li><p><a href="https://leetcode.com/problems/coin-change/description/" target="_blank" rel="external">322. Coin Change</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">coinChange</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> n = coins.size();</span><br><span class="line">    	<span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">    		return <span class="number">-1</span>;</span><br><span class="line">    	sort(coins.rbegin(),coins.rend());</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(amount+<span class="number">1</span>, amount+<span class="number">1</span>);</span><br><span class="line">    	dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">auto</span> coin : coins)</span><br><span class="line">    		<span class="keyword">for</span> (<span class="keyword">int</span> w = coin; w &lt;= amount; ++w)</span><br><span class="line">    			dp[w] = min(dp[w], dp[w-coin]+<span class="number">1</span>);</span><br><span class="line">    	return dp[amount] &gt; amount ? <span class="number">-1</span> : dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Others:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if coin[1000, 2000], there is no need for i starting at 0</span></span><br><span class="line"><span class="comment">// coins[0] + 1 may overflow if coins[0] == Integer.MAX_VALUE</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = coins[<span class="number">0</span>]; i &lt;= amount; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> coin : coins) &#123;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/combination-sum-iv/description/" target="_blank" rel="external">377. Combination Sum IV</a>, similar</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="function"><span class="keyword">int</span> <span class="title">combinationSum4</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> n = nums.size();</span><br><span class="line">    	<span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">    		return <span class="number">0</span>;</span><br><span class="line">    	sort(nums.begin(),nums.end());</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(target+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    	dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">/* remove duplicate.</span><br><span class="line">        eg. 1 1 2 = 1 2 1, since 1 will not consider again</span><br><span class="line">    	for (auto num : nums)</span><br><span class="line">    		for (int w = num; w &lt;= target; ++w)</span><br><span class="line">        */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w = nums[<span class="number">0</span>]; w &lt;= target; ++w)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> num : nums)&#123;</span><br><span class="line">                <span class="keyword">if</span> (w &lt; num)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                dp[w] += dp[w-num];</span><br><span class="line">            &#125;</span><br><span class="line">    	return dp[target];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>DP</p>
<ol>
<li>Deduction Formula</li>
<li>Initialization</li>
<li>Space Improvement (Bonus)</li>
</ol>
<ul>
<li><p>Audible 题：BugdetShopping</p>
<blockquote>
<p>n dollars, bundleQuantities array, bundleCosts array </p>
<p>eg. Helen has n = 50 dollars to purchase notebooks from 2 stores described by bundleQunantities = [20, 19] and bundleCost = [24, 20]. She makes the following purchases:<br>​    One bundle of 20 notebooks from shop 0 at a cost 24 dollars and has 50 – 24 = 26 dollars left.<br>​    Another bundle of 20 notebooks from shop 0 at a cost 24 dollars and has 26 – 24 = 2 dollars left.<br>Helen can’t afford any more notebooks, so we return the total number of notebooks she was able to purchase: 20 + 20 = 40.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// f(i) is the maximum number of notebook given i dollar</span></span><br><span class="line">f[i] = max(f[i – b.cost] + b.quantity) given different b</span><br><span class="line">maxf = <span class="number">0</span>, maxf = max(maxf, f[i])</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = bundles[<span class="number">0</span>].cost; i &lt; f.length; i++) &#123;</span><br><span class="line">	<span class="keyword">for</span> (Bundle b : bundles) &#123;</span><br><span class="line">		<span class="keyword">if</span> (b.cost &gt; i) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (i == b.cost) &#123;</span><br><span class="line">			f[i] = Math.max(f[i], b.quantity);</span><br><span class="line">			max = Math.max(max, f[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">      	<span class="keyword">int</span> c = f[i - b.cost];</span><br><span class="line">		<span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		f[i] = Math.max(f[i], c + b.quantity);</span><br><span class="line">		System.out.println(i + <span class="string">"="</span> + f[i]);</span><br><span class="line">		max = Math.max(max, f[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><strong>Coin Change is unlimited, while Knapsack is limited</strong></p>
<ul>
<li><p>背包问题</p>
<ol>
<li><p>Backpack<br>Given n items with size Ai, an integer m denotes the size of a backpack. How full you can fill this backpack?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i = [0, A.length)</span><br><span class="line">	j = [m, A[i]]</span><br><span class="line">		result[j] = max(result[j-A[i]]+A[i], result[j])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Backpack II<br>Given n items with size Ai and value Vi, and a backpack with size m. What’s the maximum value can you put into the backpack?<br>Example<br>Given 4 items with size [2, 3, 5, 7] and value [1, 5, 2, 4], and a backpack with size 10. The maximum value is 9.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i = [0, A.length)</span><br><span class="line">	j = [m, A[i]]</span><br><span class="line">		result[j] = max(result[j-A[i]]+v[i], result[j])</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Knapsack_problem" target="_blank" rel="external">https://en.wikipedia.org/wiki/Knapsack_problem</a><br><a href="https://www.geeksforgeeks.org/knapsack-problem" target="_blank" rel="external">https://www.geeksforgeeks.org/knapsack-problem</a><br><a href="https://brilliant.org/wiki/backpack-problem" target="_blank" rel="external">https://brilliant.org/wiki/backpack-problem</a></p>
</li>
</ol>
</li>
<li><p>背包问题变种</p>
<ul>
<li><p><a href="">474. Ones and Zeroes</a></p>
<blockquote>
<p>maximize chossedn string -&gt; m’s 1, n’s 0</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for k=1..l</span><br><span class="line">	i=m..s0, j=n..s1</span><br><span class="line">		dp[i][j] = max(dp[i][j],dp[i-s0][j-s1]+1)// wo/w s</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="">494. Target Sum</a></p>
<blockquote>
<p>+/- ai = s</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sum(P) - sum(N) = target           </span><br><span class="line">sum(P) + sum(N) + sum(P) - sum(N) = target + sum(P) + sum(N)</span><br><span class="line">2 * sum(P) = target + sum(nums)</span><br><span class="line"></span><br><span class="line">for num:nums</span><br><span class="line">	for w = (t+s)/2 ... num</span><br><span class="line">		dp[w] += dp[w-num]</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/partition-equal-subset-sum/description/" target="_blank" rel="external">416. Partition Equal Subset Sum</a></p>
<blockquote>
<p>find if the array can be partitioned into two subsets, that sum is equal</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sum(subset1) = sum/2</span><br><span class="line"></span><br><span class="line">for num:nums</span><br><span class="line">	for w = sum/2 ... num</span><br><span class="line">		dp[w] = dp[w]|dp[w-num]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h5 id="Thinking"><a href="#Thinking" class="headerlink" title="Thinking"></a>Thinking</h5><ul>
<li><p>DP</p>
<ol>
<li><p>先枚举物品，再枚举容量。<br>eg. [1, 2, 3] 组合4时，(1, 1, 2) == (1, 2, 1)。因为同一个物体不会再次考虑</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* remove duplicate.</span><br><span class="line">        eg. 1 1 2 = 1 2 1, since 1 will not consider again</span><br><span class="line">    	for (auto num : nums)</span><br><span class="line">    		for (int w = num; w &lt;= target; ++w)</span><br><span class="line">        */</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>先枚举容量，再枚举物品。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> w = nums[<span class="number">0</span>]; w &lt;= target; ++w)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> num : nums)</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>背包问题：</p>
<ol>
<li>枚举物品</li>
<li>枚举容量<br>增序枚举，重复装入某个物品，而且尽可能多的，使价值最大<br>逆序枚举：物品至多装一次</li>
</ol>
</li>
<li><a href="https://github.com/tianyicui/pack" target="_blank" rel="external">背包九讲</a></li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/24/Responsive-Design/" itemprop="url">
                  Responsive Design
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-24T14:55:11-07:00" content="2018-03-24">
              2018-03-24
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/24/Responsive-Design/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/24/Responsive-Design/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/24/Responsive-Design/" class="leancloud_visitors" data-flag-title="Responsive Design">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Lydna | <a href="https://www.lynda.com/Web-Responsive-Design-tutorials/Welcome/104969/115611-4.html" target="_blank" rel="external">Lerning Responsive Design</a></p>
</blockquote>
<h5 id="Responsive-Web-Design-Ethan-Marcotte"><a href="#Responsive-Web-Design-Ethan-Marcotte" class="headerlink" title="Responsive Web Design -  Ethan Marcotte"></a>Responsive Web Design -  Ethan Marcotte</h5><ol>
<li>Fluid Grid for flexible layouts</li>
<li>Media Queries to help you adapt content to specific screen sizes</li>
<li>Flexible Images and media that respond to changes in screen sizes as well.</li>
</ol>
<ul>
<li><p>HTML: clean code, proper semantics HTMLs</p>
<p>CSS: media queries, fluid layout, transitions css graphics</p>
<p>JavaScript: resourse loading, adaptive media, device functionality</p>
</li>
</ul>
<h5 id="Concepts"><a href="#Concepts" class="headerlink" title="Concepts"></a>Concepts</h5><ul>
<li><p>viewport(have a minimum scaling factor) &gt; the screen’s resolution</p>
<p>Mobile browsers will display a web page within the viewport ans the shrink that viewport down until the content fits within the width of the screen itself.  While this usually results in tiny pages, it does allow the user to see the page in its entirety and decide which areas of the page they’d like to zoom up to, and read. </p>
<p>=&gt; how to control both the viewport size and its initial scale factor.</p>
</li>
<li><p>Controlling Viewports</p>
<ol>
<li><p>viewport meta tag <code>met name=&quot;viewport&quot; content=&quot;width=480, initial-scale=1&quot;&gt;</code></p>
</li>
<li><p>@viewport CSS rule <code>@viewport{width: 480px; zoom: 1;}</code></p>
<p>should be placed before media queries</p>
</li>
</ol>
<ul>
<li><p><strong>device width</strong>: instructs the browser to set the viewport to the exact size as the available screen pixels. </p>
<p>And the browser automatically sets initial scale to 100%.</p>
<p>In fact, on iOS devices, there’s a bug with initial scale that affects pages when the orientation changes, so many people advise leaving initial scale off entirely unless you need to set the value to something other than 100%.</p>
</li>
<li><p>zoom: 2, -&gt; 200%</p>
</li>
<li><p>control how much zoom</p>
<p>eg. <code>minimum-scale=1 maximum-scale=2</code> in tag, <code>min-zoom:1; max-zoom:2</code>in CSS. The user can scale up to 200% but can’t scale down pass 100%.</p>
<p>eg. <code>user-scalable=no</code> or <code>user-zoom:fixed;</code></p>
</li>
</ul>
</li>
<li><p>Screen density is the number of pixels within a physical area of a screen, and newer screens are featuring higher and higher screen densities every year</p>
<ol>
<li><p>hardware pixels</p>
<p>eg. Let’s say you had a line of text that was 30 pixels high on a lower-density screen. The same text mapped to the higher- density screen would now appear twice as <u>small</u>. </p>
</li>
<li><p>reference pixels - “CSS pixel”</p>
<p>eg. If you’ve specified that an element be 50 pixels wide, it might map to the first screen at exactly 50 pixels if the hardware and reference pixels were the same.<br>On a higher-density screen, however, the device would actually display the same element over 100 hardware pixels to ensure that it remains the same visual size.</p>
<ul>
<li>scaling factor - device-pixel-ratio, the ratio between reference pixels and hardware pixels</li>
</ul>
</li>
</ol>
</li>
<li><p>Designing for multiple screen densities</p>
<ul>
<li><p>Optimize graphics for higher-density displays - Reduce bitmap graphics</p>
<ol>
<li><p>SVG</p>
<p>Often larger than bitmaps</p>
<p>Graphics are redrawn with each screen change</p>
</li>
<li><p>CSS</p>
<p>Complex artwork is difficult</p>
<p>Often require non-semantic markup</p>
<p>Property support isn’t universal</p>
</li>
<li><p>use icon fonts</p>
</li>
</ol>
</li>
<li><p>Screen-density targeting option</p>
<ol>
<li><p>Don’t target screen, but use high-res graphocs where needed<br>issue1: Higher-resolution graphics are larger in size -&gt; some of your users to download larger images than they really need.<br>issue2: Not all screens use the same scaling factors -&gt; you’d have to account for the largest size needed, which again leads to unnecessary file sizes in most instances. </p>
</li>
<li><p>target</p>
<p> if you are targeting CSS background images, you can use media queries to target specific device-pixel-ratios. -&gt; JavaScript</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p>Media Queries</p>
<p><code>@media [not | only] screen [and] (expression){}</code> in CSS</p>
<p><code>media=&quot;screen and (min-width: 480px), screen and (orientation: landscape)&quot;</code> in tag</p>
<p>modified: <code>@import url(example.css) screen and (max-width: 480px);</code></p>
</li>
<li><p>breakpoint: A breakpoint indicates the moment your layout switches from one layout to another, and is usually triggered by the width of a screen.</p>
<ol>
<li><code>@media only screen and (max-width: 480px){}</code> // mobile, eg. 480/16 = 30em</li>
<li><code>@media only screen and (min-width:481px) and (max-width: 768px){}</code> //tablet, 30em 48em</li>
<li><code>@media only screen and (min-width: 769px)</code> //desktop, 48em</li>
</ol>
<p>if use <code>em</code>, the width of the screen is set relative to the device’s font size.</p>
</li>
<li><p>Fluid grid</p>
<p>eg. Grid systems</p>
<p>downsides of frameworks: class-based, non-semantic, container/clearing elements, large in size/extra code</p>
</li>
<li><p>Making images responsive</p>
<ol>
<li><p>define with different @media </p>
<p>but, in <u>earlier versions of Android</u>, all of the CSS background images would be downloaded, not just the ones needed for the appropriate media query.</p>
</li>
<li><p>modify your .htaccess file, link to their responsive images JavaScript file, and add a query string on any image that requires a larger desktop version of that image.</p>
<p>but, more complex solution, JS parse slower load time(and often replacement images are requested after the original image is already downloaded.)</p>
<p>And that’s the evolution of browser prefetching: speed up load time, but may download elements that will be replaced. </p>
</li>
</ol>
<p>-&gt; </p>
<ol>
<li>WHTWQ: add a new attribute called <code>srcset</code>, eg. <code>&lt;img … src=&quot;&quot; srcset=&quot;1.png 800w, 2.png 600w&quot;&gt;</code><br>benefits: straight forward, uncluttered, no new html elements, backwards compatible</li>
<li>w3c: <code>&lt;picture&gt;&lt;source..&gt;&lt;source..&gt;&lt;img&gt;&lt;/picture&gt;</code><br>benefits: acts as parent for range of <img> elements. multiple source options with alternate images, image properties, and media queries. user agent selects matching images</li>
</ol>
</li>
<li><p>Responsive forms<br>start by considering the mobile context first<br>eg. use <code>&lt;label&gt;&lt;input.. placehold=&quot;balabala&quot; required=&quot;required&quot;&gt;&lt;/label&gt;</code><br>Makes submitting data easier, automates input when possible, and even combines form elements to require less input from the user. </p>
<ol>
<li>combile address into a single input ans use placeholder text to show format. </li>
<li>single dropdown menu instead of using a radio button grouping of multiple choices</li>
</ol>
</li>
<li><p>Performance</p>
<ul>
<li>Network connections, bandwidth speed, network latency</li>
<li>keep code lean<ol>
<li>use standards compliant code</li>
<li>elimicate extraneous markup</li>
<li>keep external scripts and styles lean and efficient</li>
</ol>
</li>
<li>limit requests<ol>
<li>eg. If you’re linking to multiple external scripts, try combining them into a single file.<br>Or tools: Filament Group’s QuickConcat, Enhance.js, which can combine files at runtime into single request.</li>
<li>Combine images and icons into sprites -&gt; use same images for multiple</li>
<li>Use data URI: allows you to embed images directly into your CSS without having to request the image from the server</li>
<li>Evaluate any external resource to make sure that you’re actually using them. </li>
<li>use a JavaScript library in one context but not the other.</li>
</ol>
</li>
</ul>
</li>
</ul>
<h5 id="Responsice-Design-Strategies"><a href="#Responsice-Design-Strategies" class="headerlink" title="Responsice Design Strategies"></a>Responsice Design Strategies</h5><ul>
<li>Designing for the appropriate:  targeting the appropriate context in which the site will be used.</li>
<li>Planning a responsie design<br>develop a content strategy, think about breakpoints<br>tweak point -&gt; allow you to refine your designs throughout the scaling proces<br>device-specific functionality: geo location, instant messaging, touch sensitivity<br>layout considerations: plan out your navigation, creat consistent coding standards</li>
<li>Building responsive mockups</li>
<li>Developing a context strategy for responsive sites<br>goas: emphasize important content, make relationship clear, make it accessible on small screens<br>start with content -&gt; think about prioritize/purpose -&gt; generate a set of rules that govern how content should be displayed and shifted as screen sizes change</li>
<li>Understanding the mobile context</li>
<li>Designing for mobile capabilities<br>location, motion/accelerometer, built in compass, media, touch screen, phone</li>
<li>Creating flexible HTML<ol>
<li>write clean code</li>
<li>use html5 if possible</li>
<li>explore microformats</li>
<li>standards for each content area</li>
<li>creat smaller sections of content, reassess layout goals/scripting</li>
</ol>
</li>
<li>Testing responsive designs</li>
</ul>
<h5 id="Conclution"><a href="#Conclution" class="headerlink" title="Conclution"></a>Conclution</h5><ul>
<li><p>Fluid grid framework</p>
<ul>
<li>benefits:<br>speed up development<br>help keep code consistent<br>solid starting code base<br>can add unnecessary code<br>some require non-semantic code</li>
</ul>
</li>
</ul>
<ul>
<li>eg. Twitter’s Bootstrap: it’s a collection of HTML, CSS, and JavaScript that includes a fluid grid, starter layouts, UI components, and much, much more. </li>
<li>eg. Skeleton:  lightweight, includes a fluid grid, basic typography controls, and default styling for forms and buttons.</li>
</ul>
<ul>
<li>Responsice design tools</li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/22/X5-Interval-Sliding-Window/" itemprop="url">
                  X5_Interval & Sliding Window
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-22T15:39:57-07:00" content="2018-03-22">
              2018-03-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index">
                    <span itemprop="name">Program</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/22/X5-Interval-Sliding-Window/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/22/X5-Interval-Sliding-Window/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/22/X5-Interval-Sliding-Window/" class="leancloud_visitors" data-flag-title="X5_Interval & Sliding Window">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h5><ul>
<li><p>Merge Intervals</p>
<ul>
<li><p>follow up</p>
<p>list in java is not thread safe: synchronized</p>
<p>concurrent list java</p>
</li>
<li><p>note</p>
<ol>
<li>先确认signature，再确认requirement<br>work through test，画图说明</li>
<li>compare的时候要用Integer.compare，而不是相减，会溢出</li>
<li>collection.sort是modified merge sort（因为stable，保持相对顺序，eg. 1 2 2’ 3不会出现1 2’ 2 3）<br>object use merge sort，primitive type use quick sort</li>
<li>用collections.emptyList()，是系统初始化好的，不用开辟额外的空间。如果用new Arraylist&lt;&gt;()会占新的空间</li>
<li>Runtime, 要根据代码nlogn</li>
<li>test case copy到代码附近</li>
<li>定义res时候直接最下面写return res。显得有条理</li>
<li>先定义cur，而不是每次a.get(i )，更清晰</li>
</ol>
</li>
<li><p>FB变种，raindrop</p>
<p>rope 0-1, [0.2,0.5], [0.75,1.0], [0.3,0.75]</p>
<ol>
<li><p>deal with float<br>private static final float EPSILON = 1e-10<br>Math.abs(a-b) &lt; EPSILON</p>
</li>
<li><p>If drops are given on by one. Not all in the begining. -&gt; 57. insert Interval</p>
<p>boolean isWet, 0-1 all is wet</p>
<p>注意处理边界，如果drop&gt;1</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>Comparable vs Comparator in Java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义在class内部</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Movie</span>&gt;</span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Movie m)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">Collection.sort(list);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义专门的compare函数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RatingCompare</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">Movie</span>&gt;</span>&#123;</span><br><span class="line">  <span class="function">pulic <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Movie m1, Movie m2)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">RatingCompare ratingCompare = <span class="keyword">new</span> <span class="function">Rating <span class="title">Compare</span><span class="params">()</span></span>;</span><br><span class="line">Collection.sort(list, ratingCompare);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Amazon OA Window Sum</p>
<blockquote>
<p> 给定数组，给定长度，算出数组里面，在这个长度下，分别的连续和</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Given array: [1,2,3,4,5,6,7]</span><br><span class="line">&gt; Given window: 3</span><br><span class="line">&gt; Output: [6,9,12,15,18]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>Sliding Window</strong></p>
</li>
<li><p>Hard: <a href="https://leetcode.com/problems/maximum-sum-of-3-non-overlapping-subarrays" target="_blank" rel="external">689. Maximum Sum of 3 Non-Overlapping Subarrays</a></p>
<p>find 3, fixed subarray size = k =&gt; linear time</p>
<p>else , not linear time, different sol, is similar to the buy and sell stock problem.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1, 2, 1, 2, 6, 7, 5, 1</span><br><span class="line">...........[s1  ].....</span><br><span class="line">maxFromLeft      maxFromRight</span><br><span class="line">       1, 2, 1, 2, 6, 7, 5, 1</span><br><span class="line">presum:3, 3, 3, 8,13,12, 6 </span><br><span class="line">maxFL: 0, 0, 0, 3, 4       &lt;-index</span><br><span class="line">       3, 3, 3, 8, 13      &lt;-value</span><br><span class="line">maxFR: 0, 0, 0, 0, 4, 5, 6 &lt;-index</span><br><span class="line">       ., ., ., .,13,12, 6 &lt;-value</span><br><span class="line">     </span><br><span class="line">s1: [k, n-2k]; s0:[0,i-k]; s2:[i+k,n-1]</span><br><span class="line">sum = presum[maxFromLeft[i - k]] + presum[i] + presum[maxFromRight[i + k]]</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; maxSumOfThreeSubarrays(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">    	<span class="keyword">int</span> n = nums.size();</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; presum(n,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">long</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">        	<span class="keyword">if</span> (i&gt;=k)&#123;</span><br><span class="line">        		presum[i-k] = sum;</span><br><span class="line">        		sum -= nums[i-k];</span><br><span class="line">        	&#125;</span><br><span class="line">        	sum += nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        presum[n-k] = sum;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; maxFL(n,<span class="number">0</span>), maxFR(n,<span class="number">0</span>);</span><br><span class="line">        sum = <span class="number">0</span>; <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n<span class="number">-3</span>*k; ++i)&#123;</span><br><span class="line">        	<span class="keyword">if</span> (presum[i] &gt; sum)&#123;</span><br><span class="line">        		sum = presum[i];</span><br><span class="line">        		idx = i;</span><br><span class="line">        	&#125;</span><br><span class="line">        	maxFL[i] = idx;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = <span class="number">0</span>; idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n-k; i &gt;= <span class="number">2</span>*k; --i)&#123;</span><br><span class="line">			<span class="keyword">if</span> (presum[i] &gt; sum)&#123;</span><br><span class="line">        		sum = presum[i];</span><br><span class="line">        		idx = i;</span><br><span class="line">        	&#125;</span><br><span class="line">        	maxFR[i] = idx;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = <span class="number">0</span>; idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &lt;= n<span class="number">-2</span>*k; ++i)&#123;</span><br><span class="line">        	<span class="keyword">long</span> tmp = presum[maxFL[i-k]]+presum[i]+presum[maxFR[i+k]];</span><br><span class="line">        	<span class="keyword">if</span> (tmp &gt; sum)&#123;</span><br><span class="line">        		sum = tmp;</span><br><span class="line">        		idx = i;</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;   </span><br><span class="line">        return &#123;maxFL[idx-k], idx, maxFR[idx+k]&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p><strong>Interfaces and Inheritance in Java</strong></p>
<p>Interface inheitance: An Interface can extend other interface.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Class: Smple —implements—&gt; Interface: intFB —extends—&gt;Interface: intFA</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">intFA</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">geekName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">intFB</span> <span class="keyword">extends</span> <span class="title">intFA</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">geekInstitute</span><span class="params">()</span></span><br><span class="line">&#125;</span><br><span class="line">class sample implements intFB</span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">geekName</span><span class="params">()</span></span>&#123;...&#125;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">geekInstitute</span><span class="params">()</span></span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Airbnb: <a href="https://leetcode.com/problems/employee-free-time" target="_blank" rel="external">759. Employee Free Time</a></p>
<blockquote>
<p>We are given a list <code>schedule</code> of employees, which represents the working time for each employee.</p>
<p>Each employee has a list of non-overlapping <code>Intervals</code>, and these intervals are in sorted order.</p>
<p>Return the list of finite intervals representing <strong>common, positive-length free time</strong> for <em>all</em> employees, also in sorted order.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: schedule = [[[1,2],[5,6]],[[1,3]],[[4,10]]]</span><br><span class="line">&gt; Output: [[3,4]]</span><br><span class="line">&gt; Explanation:</span><br><span class="line">&gt; There are a total of three employees, and all common</span><br><span class="line">&gt; free time intervals would be [-inf, 1], [3, 4], [10, inf].</span><br><span class="line">&gt; We discard any intervals that contain inf as they aren&apos;t finite.</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: schedule = [[[1,3],[6,7]],[[2,4]],[[2,5],[9,12]]]</span><br><span class="line">&gt; Output: [[5,6],[7,9]]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//similar to 252, 253</span></span><br><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;Interval&gt; employeeFreeTime(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;Interval&gt;&gt;&amp; schedule) &#123;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; starts, ends;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">auto</span> s:schedule)</span><br><span class="line">    		<span class="keyword">for</span> (<span class="keyword">auto</span> i:s)&#123;</span><br><span class="line">	    		starts.push_back(i.start);</span><br><span class="line">	    		ends.push_back(i.end);</span><br><span class="line">    		&#125;</span><br><span class="line">    	sort(starts.begin(),starts.end());</span><br><span class="line">    	sort(ends.begin(),ends.end());</span><br><span class="line">    	<span class="built_in">vector</span>&lt;Interval&gt; ans;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; starts.size() - <span class="number">1</span>; ++i)</span><br><span class="line">    		<span class="keyword">if</span> (ends[i] &lt; starts[i+<span class="number">1</span>])</span><br><span class="line">    			ans.push_back(Interval(ends[i],starts[i+<span class="number">1</span>]));</span><br><span class="line">    		<span class="comment">// ==&gt; starts[ends[i].index] &lt; starts[i+1]</span></span><br><span class="line">    		<span class="comment">// ==&gt; there is i starts and they have already ended</span></span><br><span class="line">    		<span class="comment">// ==&gt; there is free interval x before next i+1 start</span></span><br><span class="line">    	return ans; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/merge-intervals" target="_blank" rel="external">56. Merge Intervals</a> | <strong>Sort</strong></p>
<blockquote>
<p>Given a collection of intervals, merge all overlapping intervals.</p>
<p>For example,<br>Given <code>[1,3],[2,6],[8,10],[15,18]</code>,<br>return <code>[1,6],[8,10],[15,18]</code>.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;Interval&gt; merge(<span class="built_in">vector</span>&lt;Interval&gt;&amp; intervals) &#123;</span><br><span class="line">        <span class="keyword">if</span> (intervals.empty())</span><br><span class="line">            return &#123;&#125;;</span><br><span class="line">        sort(intervals.begin(), intervals.end(), [](Interval a, Interval b)&#123;return a.start &lt; b.start;&#125;);</span><br><span class="line">        <span class="keyword">int</span> end = intervals[<span class="number">0</span>].end, beg = intervals[<span class="number">0</span>].start;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Interval&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;intervals.size(); i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (intervals[i].start&lt;=end)</span><br><span class="line">                end = max(end,intervals[i].end);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ans.push_back(Interval(beg,end));</span><br><span class="line">                beg = intervals[i].start;</span><br><span class="line">                end = intervals[i].end;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (beg!=<span class="number">-1</span>)</span><br><span class="line">            ans.push_back(Interval(beg,end));</span><br><span class="line">        return ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/merge-k-sorted-lists/description/" target="_blank" rel="external">23. Merge k Sorted Lists</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> compare&#123;</span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> ListNode* l1, <span class="keyword">const</span> ListNode* l2)</span></span>&#123;</span><br><span class="line">    return l1-&gt;val &gt; l2-&gt;val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> Solution&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function">ListNode* <span class="title">mergeKLists</span><span class="params">(<span class="built_in">vector</span>&lt;ListNode*&gt;&amp; lists)</span></span>&#123;</span><br><span class="line">    priority_queue&lt;ListNode*, <span class="built_in">vector</span>&lt;ListNode*&gt;, compare&gt; q;</span><br><span class="line">    <span class="comment">//for (ListNode* l:lists)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> l:lists)</span><br><span class="line">      <span class="keyword">if</span> (l)</span><br><span class="line">        q.push(l);</span><br><span class="line">    <span class="keyword">if</span> (q.empty())</span><br><span class="line">      return <span class="literal">NULL</span>;</span><br><span class="line">    ListNode* ans = q.top();</span><br><span class="line">    ListNode* h = ans;</span><br><span class="line">    q.pop();</span><br><span class="line">    <span class="keyword">if</span> (h-&gt;next) q.push(h-&gt;next);</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">      h-&gt;next = q.top();</span><br><span class="line">      q.pop();</span><br><span class="line">      h = h-&gt;next;</span><br><span class="line">      <span class="keyword">if</span> (h-&gt;next) q.push(h-&gt;next);</span><br><span class="line">    &#125;</span><br><span class="line">    return ans;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Or, binary use Merge2Lists</p>
</li>
</ul>
<h5 id="Materials"><a href="#Materials" class="headerlink" title="Materials"></a>Materials</h5><p> <a href="http://mp.weixin.qq.com/s?__biz=MzUzODEyMzIyOA==&amp;mid=2247483961&amp;idx=1&amp;sn=8e1dc896158b2f2f6dd63ea8a1e9ef09&amp;chksm=faddcc8acdaa459c32fdb3ec3095397b9ff2c05e845eb2cf47526f349233aae8405e43767840&amp;scene=21#wechat_redirect" target="_blank" rel="external">Meeting Rooms II -Interval  所有题型总结归纳</a></p>
<ul>
<li><p><a href="https://leetcode.com/problems/k-empty-slots/" target="_blank" rel="external">683. K Empty Slots</a> | <strong>sliding window</strong></p>
<blockquote>
<p>There is a garden with <code>N</code> slots. In each slot, there is a flower. The <code>N</code> flowers will bloom one by one in <code>N</code> days. In each day, there will be <code>exactly</code> one flower blooming and it will be in the status of blooming since then.</p>
<p>Given an array <code>flowers</code> consists of number from <code>1</code> to <code>N</code>. Each number in the array represents the place where the flower will open in that day.</p>
<p>For example, <code>flowers[i] = x</code> means that the unique flower that blooms at day <code>i</code> will be at position <code>x</code>, where <code>i</code> and <code>x</code> will be in the range from <code>1</code> to <code>N</code>.</p>
<p>Also given an integer <code>k</code>, you need to output in which day there exists two flowers in the status of blooming, and also the number of flowers between them is <code>k</code> and these flowers are not blooming.</p>
<p>If there isn’t such day, output -1.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: </span><br><span class="line">&gt; flowers: [1,3,2]</span><br><span class="line">&gt; k: 1</span><br><span class="line">&gt; Output: 2</span><br><span class="line">&gt; Explanation: In the second day, the first and the third flower have become blooming.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: </span><br><span class="line">&gt; flowers: [1,2,3]</span><br><span class="line">&gt; k: 1</span><br><span class="line">&gt; Output: -1</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p><strong>Note:</strong></p>
<ol>
<li>The given array will be in the range [1, 20000].</li>
</ol>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line">flowers[i] = x : the unique flower that blooms at day i+1 will be at position x</span><br><span class="line">=&gt; day[x-1] = i+1</span><br><span class="line"></span><br><span class="line">x1 = f[i], x2 = f[j], x1 &lt; x2</span><br><span class="line">sum( x1 &lt; f[max(i,j)+1...N-1] &lt; x2) == k</span><br><span class="line">=&gt;</span><br><span class="line">sliding window</span><br><span class="line">left = x, right = x+k+1</span><br><span class="line">day[x+1]...day[x+k] &gt; max(day[left],day[right])</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kEmptySlots</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; flowers, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> ans = INT_MAX;</span><br><span class="line">    	<span class="keyword">int</span> n = flowers.size();</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; days(n,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    		days[flowers[i]<span class="number">-1</span>] = i + <span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">int</span> left = <span class="number">0</span>, right = k+<span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">int</span> day = max(days[left],days[right]);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; right &lt; n; ++i)&#123;</span><br><span class="line">    		<span class="keyword">if</span> (days[i] &gt; day)</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		<span class="keyword">if</span> (i == right) <span class="comment">// find one</span></span><br><span class="line">    			ans = min(ans,day);</span><br><span class="line">    		left = i;</span><br><span class="line">    		right = i+k+<span class="number">1</span>;</span><br><span class="line">    		day = max(days[left],days[right]);</span><br><span class="line">    	&#125;</span><br><span class="line">    	return ans == INT_MAX ? <span class="number">-1</span> : ans;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/meeting-rooms" target="_blank" rel="external">252. Meeting Rooms</a> | <strong>Sort</strong></p>
<blockquote>
<p>Given an array of meeting time intervals consisting of start and end times <code>[[s1,e1],[s2,e2],...]</code> (si &lt; ei), determine if a person could attend all meetings.</p>
<p>For example,<br>Given <code>[[0, 30],[5, 10],[15, 20]]</code>,<br>return <code>false</code>.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Definition for an interval.</span><br><span class="line"> * struct Interval &#123;</span><br><span class="line"> *     int start;</span><br><span class="line"> *     int end;</span><br><span class="line"> *     Interval() : start(0), end(0) &#123;&#125;</span><br><span class="line"> *     Interval(int s, int e) : start(s), end(e) &#123;&#125;</span><br><span class="line"> * &#125;;</span><br><span class="line"> */</span></span><br><span class="line"><span class="comment">// sort with start time, itv[i].end&gt;itc[i+1].start -&gt; overloap</span></span><br><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canAttendMeetings</span><span class="params">(<span class="built_in">vector</span>&lt;Interval&gt;&amp; intervals)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> n = intervals.size();</span><br><span class="line">    	<span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">    		return <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">auto</span> comp = [](Interval&amp; a, Interval&amp; b)&#123;</span><br><span class="line">    		return a.start &lt; b.start;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	sort(intervals.begin(),intervals.end(),comp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n<span class="number">-1</span>; ++i)</span><br><span class="line">        	<span class="keyword">if</span> (intervals[i].end &gt; intervals[i+<span class="number">1</span>].start)</span><br><span class="line">        		return <span class="literal">false</span>;</span><br><span class="line">        return <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/meeting-rooms-ii/description/" target="_blank" rel="external">253. Meeting Rooms II</a></p>
<blockquote>
<p>Given an array of meeting time intervals consisting of start and end times <code>[[s1,e1],[s2,e2],...]</code> (si &lt; ei), find the minimum number of conference rooms required.</p>
<p>For example,<br>Given <code>[[0, 30],[5, 10],[15, 20]]</code>,<br>return <code>2</code>.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line">sort with start &amp; sort with end</span><br><span class="line">i, j &lt;= i</span><br><span class="line">if si &lt; ej &lt;=&gt; i==j | when i comes, j is not end</span><br><span class="line">=&gt; overlap &amp;&amp; ej&lt;=i.end </span><br><span class="line">=&gt; since ej&lt;=i.end, add another room -&gt; i, next i</span><br><span class="line">ele next j </span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minMeetingRooms</span><span class="params">(<span class="built_in">vector</span>&lt;Interval&gt;&amp; intervals)</span> </span>&#123;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; starts, ends;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">auto</span> i:intervals)&#123; <span class="comment">// store with idx</span></span><br><span class="line">    		starts.push_back(i.start); </span><br><span class="line">    		ends.push_back(i.end);</span><br><span class="line">    	&#125;</span><br><span class="line">    	sort(starts.begin(),starts.end());</span><br><span class="line">    	sort(ends.begin(),ends.end());</span><br><span class="line">    	<span class="keyword">int</span> ans = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; intervals.size(); ++i)</span><br><span class="line">    		<span class="keyword">if</span> (starts[i] &lt; ends[j])</span><br><span class="line">    			++ ans; <span class="comment">// rnum[i.idx] = ans++;</span></span><br><span class="line">    		<span class="keyword">else</span> <span class="comment">// can schedule after j</span></span><br><span class="line">    			++ j; <span class="comment">// rnum[i.idx] = rnum[j++.idx]</span></span><br><span class="line">    	return ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>follow up问题：把每个 meeting room 中的 intervals 打印出来</strong></p>
</li>
<li><p>Given two lists of intervals, find their overlapping intervals. For example: l1: [1,5], [7,10], [12,18], [22,24], l2: [3,8], [13,15], [16,17], [18,21], [22,23]<br>returns [3,5], [7,8], [13,15], [16,17], [18,18], [22,23]</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if there is something wrong, please correct me</span></span><br><span class="line">two pointers: i, j</span><br><span class="line"><span class="keyword">if</span> Ai overlap Bj, </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; overlap</span><br><span class="line">  <span class="keyword">if</span> ie = je, i++, j++,</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span> is &lt;= js, i++, je = ie + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> j++, ie = je +<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">  <span class="keyword">if</span> is &lt; ie &lt;= js &lt; je, i++</span><br><span class="line">  <span class="keyword">else</span> j++</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sort with start &amp; sort with end, then</span></span><br><span class="line"><span class="keyword">int</span> count = <span class="number">0</span>, start = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; j &lt; ends.length;) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i &lt; begs.length &amp;&amp; begs[i] &lt; ends[j]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (++count == <span class="number">2</span>) &#123;</span><br><span class="line">					<span class="comment">// enter overlap</span></span><br><span class="line">					start = begs[i];</span><br><span class="line">				&#125;</span><br><span class="line">				i++;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i == begs.length || begs[i] &gt; ends[j]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (--count == <span class="number">1</span>) &#123;</span><br><span class="line">					<span class="comment">// exit overlap</span></span><br><span class="line">					res.add(<span class="keyword">new</span> Interval(start, ends[j]));</span><br><span class="line">				&#125;</span><br><span class="line">				j++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// begs[i] == ends[j]</span></span><br><span class="line">				<span class="keyword">if</span> (count &gt; <span class="number">1</span>) &#123;</span><br><span class="line">					<span class="comment">// already in overlap</span></span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				res.add(<span class="keyword">new</span> Interval(begs[i++], ends[j++]));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure>
</li>
<li><p>N个员工，每个员工有若干个interval表示在这段时间是忙碌的。求所有员工都不忙的intervals。每个subarray都已经sort好。<br>举例： [<br>[[1, 3], [6, 7]],<br> [[2, 4]],<br> [[2, 3], [9, 12]].<br>]<br>返回 [[4, 6], [7, 9]]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sort with start &amp; sort with end, then</span></span><br><span class="line"><span class="keyword">int</span> count = <span class="number">0</span>, start = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; begs.length;) &#123;</span><br><span class="line">			<span class="keyword">if</span> (begs[i] &lt; ends[j]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (++count == <span class="number">1</span>) &#123;</span><br><span class="line">					<span class="comment">// exit free time</span></span><br><span class="line">					<span class="keyword">if</span> (start &gt; <span class="number">0</span>) &#123;</span><br><span class="line">						res.add(<span class="keyword">new</span> Interval(start, begs[i]));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				i++;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (begs[i] &gt; ends[j]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (--count == <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="comment">// start free zone</span></span><br><span class="line">					start = ends[j];</span><br><span class="line">				&#125;</span><br><span class="line">				j++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// begs[i] == ends[j]</span></span><br><span class="line">				i++;</span><br><span class="line">				j++;</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(res);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p><img src="https://mmbiz.qpic.cn/mmbiz_png/4g8gMp5OMibAIXfDBwMv5ZQHDExQBFPt55Ot7uwn7ceicUibS84dEjrwxIRNIzibZAuPpKiadnSeDv14Z42uVicoUib1A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>​</p>
</li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/21/What-happens-when-you-type-an-URL-in-the-browser/" itemprop="url">
                  What happens when you type an URL in the browser
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-21T15:50:25-07:00" content="2018-03-21">
              2018-03-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/21/What-happens-when-you-type-an-URL-in-the-browser/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/21/What-happens-when-you-type-an-URL-in-the-browser/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/21/What-happens-when-you-type-an-URL-in-the-browser/" class="leancloud_visitors" data-flag-title="What happens when you type an URL in the browser">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="Reference-I"><a href="#Reference-I" class="headerlink" title="Reference I"></a>Reference I</h5><ul>
<li><a href="https://stackoverflow.com/questions/2092527/what-happens-when-you-type-in-a-url-in-browser" target="_blank" rel="external">what happens when you type in a URL in browser</a></li>
<li><a href="https://medium.com/@maneesha.wijesinghe1/what-happens-when-you-type-an-url-in-the-browser-and-press-enter-bb0aa2449c1a" target="_blank" rel="external">What happens when you type an URL in the browser and press enter?</a></li>
</ul>
<h5 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h5><blockquote>
<p>Attention: this is an extremely rough and <strong>oversimplified</strong> sketch, assuming the simplest possible HTTP request (no HTTPS, no HTTP2, no extras), simplest possible DNS, no proxies, single-stack IPv4, one HTTP request only, a simple HTTP server on the other end, and no problems in any step. </p>
</blockquote>
<ol>
<li><p>browser checks cache; if requested object is in cache and is fresh, skip to #9</p>
<p>1) Browser cache. The browser maintains a repository of DNS records for a fixed duration for websites you have previously visited</p>
</li>
<li><p>browser asks OS for server’s IP address</p>
<p>2) OS cache.  the browser would make a system call (i.e. <em>gethostname</em> on Windows) to your underlying computer OS</p>
<p>3) Router cache. </p>
<p>4) ISP cache. Your ISP maintains its’ own DNS server which includes a cache of DNS records.</p>
</li>
<li><p>OS makes a DNS lookup and replies the IP address to the browser</p>
<p><strong>DNS</strong>(Domain Name System) is a database that maintains the name of the website (URL) and the particular IP address it links to. The main purpose of DNS is human-friendly navigation. </p>
<p>a <strong>recursive search</strong> since the search will continue repeatedly from DNS server to DNS server until it either finds the IP address we need or returns an error response saying it was unable to find it.</p>
<p>call the ISP’s DNS server a DNS recursor -&gt;  other DNS servers are called name servers</p>
<p>eg. DNS recursor -&gt; root name server -&gt; <strong>.com</strong> domain name server -&gt; <strong>google.com</strong> name server, find the matching IP address</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*udK6jZ3PjlhjqW8U.png" alt=""></p>
<p>​</p>
</li>
<li><p>browser opens a TCP connection to server (this step is much more complex with HTTPS)</p>
<p>TCP/IP <strong>three-way handshake</strong>: the client and the server exchange SYN(synchronize) and ACK(acknowledge) </p>
</li>
<li><p>browser sends the HTTP request through TCP connection</p>
<p> GET/POST request, also contain additional information such as browser identification (<em>User-Agent</em> header), types of requests that it will accept (<em>Accept</em>header), and connection headers asking it to keep the TCP connection alive for additional requests.</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*SyxEqHOBZElX5laf.png" alt="Example"></p>
</li>
<li><p>browser receives HTTP response and may close the TCP connection, or reuse it for another request</p>
<p>The server response contains the web page you requested as well as the status code, compression type (<em>Content-Encoding)</em>, how to cache the page (<em>Cache-Control</em>), any cookies to set, privacy information, etc.</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*ifRt45gihG_AwR3Z.png" alt="Example"></p>
</li>
<li><p>browser checks if the response is a redirect or a conditional response (3xx result status codes), authorization request (401), error (4xx and 5xx), etc.; these are handled differently from normal responses (2xx)</p>
</li>
<li><p>if cacheable, response is stored in cache</p>
</li>
<li><p>browser decodes response (e.g. if it’s gzipped)</p>
</li>
<li><p>browser determines what to do with response (e.g. is it a HTML page, is it an image, is it a sound clip?)</p>
</li>
<li><p>browser renders response, or offers a download dialog for unrecognized types</p>
<p>First, it will render the bare bone HTML skeleton.</p>
<p>Then it will check the HTML tags and sends out GET requests for additional elements on the web page, such as images, CSS stylesheets, JavaScript files etc. These static files are cached by the browser so it doesn’t have to fetch them again the next time you visit the page. </p>
<p>At the end, you’ll see the page</p>
</li>
</ol>
<h5 id="Reference-II"><a href="#Reference-II" class="headerlink" title="Reference II"></a>Reference II</h5><ul>
<li><a href="http://www.dailichun.com/2018/03/12/whenyouenteraurl.html" target="_blank" rel="external">从输入URL到页面加载的过程？如何由一道题完善自己的前端知识体系！</a></li>
<li><a href="http://fex.baidu.com/blog/2014/05/what-happen/" target="_blank" rel="external">从输入 URL 到页面加载完成的过程中都发生了什么事情？</a></li>
</ul>
<h5 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h5><ol>
<li><p>从浏览器接收url到开启网络请求线程（这一部分可以展开浏览器的机制以及进程与线程之间的关系）</p>
<ul>
<li>浏览器多进程：Browser进程（主控），第三方插件进程，GPU进程，浏览器渲染进程（内核，默认每个Tab页面一个进程）</li>
<li>多线程的浏览器内核<br><img src="https://dailc.github.io/staticResource/blog/basicKnowledge/whenyouenteraurl/browser_inner_thread.png" alt=""></li>
<li>解析URL：<code>protocol</code>://<code>host</code>:<code>port</code>/<code>path</code>/<code>query</code>#<code>fragment</code></li>
</ul>
</li>
<li><p>开启网络线程到发出一个完整的http请求（这一部分涉及到dns查询，tcp/ip请求，五层因特网协议栈等知识）</p>
<ul>
<li><p>DNS解析 -&gt; IP Adress</p>
</li>
<li><p><code>tcp/ip</code>请求构建：3次握手规则建立连接，断开连接时的四次挥手</p>
</li>
<li><p>五层因特网协议栈：</p>
<ol>
<li>应用层(dns,http) DNS解析成IP并发送http请求</li>
<li>传输层(tcp,udp) 建立tcp连接（三次握手）</li>
<li>网络层(IP,ARP) IP寻址</li>
<li>数据链路层(PPP) 封装成帧</li>
<li>物理层(利用物理介质传输比特流) 物理传输（然后传输的时候通过双绞线，电磁波等各种介质）</li>
</ol>
<p>OSI七层框架：<code>物理层</code>、<code>数据链路层</code>、<code>网络层</code>、<code>传输层</code>、<code>会话层</code>、<code>表示层</code>、<code>应用层</code></p>
<ol>
<li>表示层：主要处理两个通信系统中交换信息的表示方式，包括数据格式交换，数据加密与解密，数据压缩与终端类型转换等</li>
<li>会话层：它具体管理不同用户和进程之间的对话，如控制登陆和注销过程</li>
</ol>
</li>
</ul>
</li>
<li><p>从服务器接收到请求到对应后台接收到请求（这一部分可能涉及到负载均衡，安全拦截以及后台内部的处理等等）</p>
<p><strong>负载均衡</strong>：用户发起的请求都指向调度服务器（反向代理服务器，譬如安装了nginx控制负载均衡），然后调度服务器根据实际的调度算法，分配不同的请求给对应集群中的服务器执行，然后调度器等待实际服务器的HTTP响应，并将它反馈给用户</p>
</li>
<li><p>后台和前台的http交互（这一部分包括http头部、响应码、报文结构、cookie等知识，可以提下静态资源的cookie优化，以及编码解码，如gzip压缩等）</p>
<p><img src="https://dailc.github.io/staticResource/blog/basicKnowledge/whenyouenteraurl/http_ajax_headers.png" alt="Example"></p>
</li>
<li><p>单独拎出来的缓存问题，http的缓存（这部分包括http缓存头部，etag，catch-control等）</p>
<p><code>强缓存</code>（<code>200 from cache</code>）与<code>协商缓存</code>（<code>304</code>）</p>
<p><img src="https://dailc.github.io/staticResource/blog/basicKnowledge/whenyouenteraurl/http_cache.png" alt=""></p>
</li>
<li><p>浏览器接收到http数据包后的解析流程（解析html-词法分析然后解析成dom树、解析css生成css规则树、合并成render树，然后layout、painting渲染、复合图层的合成、GPU绘制、外链资源的处理、loaded和domcontentloaded等）</p>
<p><img src="https://dailc.github.io/staticResource/blog/basicKnowledge/whenyouenteraurl/browser_rending.png" alt=""></p>
<ol>
<li><p>解析HTML，构建DOM树</p>
</li>
<li><p>解析CSS，生成CSS规则树</p>
</li>
<li><p>合并DOM树和CSS规则，生成render树</p>
<p><img src="https://dailc.github.io/staticResource/blog/basicKnowledge/whenyouenteraurl/browser_parse_rendertree.png" alt=""></p>
</li>
<li><p>布局render树（Layout(reflow)/reflow），负责各元素尺寸、位置的计算</p>
</li>
<li><p>绘制render树（paint），绘制页面像素信息</p>
</li>
<li><p>浏览器会将各层的信息发送给GPU，GPU会将各层合成（composite），显示在屏幕上</p>
</li>
</ol>
</li>
<li><p>CSS的可视化格式模型（元素的渲染规则）</p>
<ol>
<li><p>包含块（Containing Block）</p>
</li>
<li><p>控制框（Controlling Box）</p>
</li>
<li><p>BFC（Block Formatting Context）</p>
<p>如何触发BFC？</p>
<ol>
<li>根元素</li>
<li><code>float</code>属性不为<code>none</code></li>
<li><code>position</code>为<code>absolute</code>或<code>fixed</code></li>
<li><code>display</code>为<code>inline-block</code>, <code>flex</code>, <code>inline-flex</code>，<code>table</code>，<code>table-cell</code>，<code>table-caption</code></li>
<li><code>overflow</code>不为<code>visible</code></li>
</ol>
</li>
<li><p>IFC（Inline Formatting Context）：行内元素自身如何显示以及在框内如何摆放的渲染规则</p>
</li>
</ol>
</li>
<li><p>JS引擎解析过程（JS的解释阶段，预处理阶段，执行阶段生成执行上下文，VO，作用域链、回收机制等等）</p>
<ul>
<li>即时编译（<code>JIT-Just In Time compiler</code>）<ol>
<li>读取代码，进行词法分析（Lexical analysis），然后将代码分解成词元（token）</li>
<li>对词元进行语法分析（parsing），然后将代码整理成语法树（syntax tree）</li>
<li>使用翻译器（translator），将代码转为字节码（bytecode）</li>
<li>使用字节码解释器（bytecode interpreter），将字节码转为机器码</li>
</ol>
</li>
</ul>
</li>
</ol>
<ul>
<li><p>JS的预处理阶段：<a href="http://inimino.org/~inimino/blog/javascript_semicolons" target="_blank" rel="external">Semicolon Insertion</a>规则，分号补全，变量提升</p>
</li>
<li><p>JS的执行阶段</p>
<ul>
<li><p>变量对象(<code>Variable object，VO</code>)</p>
</li>
<li><p>作用域链(<code>Scope chain</code>)</p>
</li>
<li><p><code>this</code>：this的值只取决中进入上下文时的情况</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> baz = <span class="number">200</span>;</span><br><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">    baz: <span class="number">100</span>,</span><br><span class="line">    foo: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.baz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> foo = bar.foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 进入环境：global</span></span><br><span class="line">foo(); <span class="comment">// 200，严格模式中会报错，Cannot read property 'baz' of undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 进入环境：global bar</span></span><br><span class="line">bar.foo(); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>回收机制</p>
<ul>
<li>simple GC：<code>mark and sweep</code>（标记清除），引用计数</li>
<li><strong>分代回收（Generation GC）</strong><ul>
<li>多回收“临时对象”区（<code>young generation</code>）</li>
<li>少回收“持久对象”区（<code>tenured generation</code>）</li>
<li>减少每次需遍历的对象，从而减少每次GC的耗时</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>其它（可以拓展不同的知识模块，如跨域，web安全，hybrid模式等等内容）</li>
</ol>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/17/X4-Design-Tiny-URL-Skyline-Problem/" itemprop="url">
                  X4_Design Tiny URL | Skyline Problem
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-17T17:01:08-07:00" content="2018-03-17">
              2018-03-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-Design/" itemprop="url" rel="index">
                    <span itemprop="name">System Design</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-Design/Program/" itemprop="url" rel="index">
                    <span itemprop="name">Program</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-Design/Program/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/17/X4-Design-Tiny-URL-Skyline-Problem/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/17/X4-Design-Tiny-URL-Skyline-Problem/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/17/X4-Design-Tiny-URL-Skyline-Problem/" class="leancloud_visitors" data-flag-title="X4_Design Tiny URL | Skyline Problem">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Design-A-Tiny-URL-system"><a href="#Design-A-Tiny-URL-system" class="headerlink" title="Design A Tiny URL system"></a>Design A Tiny URL system</h4><h5 id="System-Design"><a href="#System-Design" class="headerlink" title="System Design"></a>System Design</h5><ul>
<li>is always about trade-off &amp;&amp; weighing pros and cons &amp;&amp; constraints</li>
<li>is also about sacrificing what is not needed &amp;&amp; optimizing what is most needed</li>
</ul>
<h5 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h5><ul>
<li><p>Ask requirement first: uique URL &lt;-&gt; unique alias</p>
</li>
<li><p>Ask Read or Write heavy: eg. Twitter: read heavy</p>
</li>
<li><p>Constraints</p>
<ol>
<li>Amount of data to store</li>
<li>Amount of traffic — QPS or the query-per-second rate(read)</li>
<li>How many new URLs per second(write)</li>
<li>Peak time / Hot spot(-&gt;Region)</li>
<li>Projection (10X times) Scalability</li>
</ol>
</li>
<li><p>Numbers, eg. </p>
<ol>
<li>Daily active users: 1,000,000</li>
<li>Insert: Per day: 1,000,000 <em> 1%(function usage) </em> 10(function frequency) = 100,000</li>
<li>Loop up: Per day: 1,000,000 <em> 100%(function usage) </em> 3(function frequency) = 3,000,000</li>
</ol>
</li>
<li><p>URLs: (lower case alphabet 26+upper case alphabet 26+ digit10)^length(=6) ~= 56.8 billions</p>
</li>
<li><p>Design 接口: REST APIs</p>
<ul>
<li>Status Code: 1xx Informational responses; 2XX Success, 200 success, 201 created; 3XX Redirection, 301 moved permanently; 4xx Client errors; 5xx Server errors</li>
<li>Google URL Shortener, json</li>
</ul>
</li>
<li><p>存储: SQL or NoSQL?</p>
<ol>
<li>是否需要丰富的 SQL Query？ NoSQL的SQL Query丰富度不如SQL，不过目前差距正在缩小，比如 MongoDB。此题不需要，该因素可以忽略。</li>
<li>是否追求效率？大多数Web Framework与SQL数据库兼容得很好(自带ORM(Object,-&gt; SQL dialect)，意味着可以少些很多代码。此题没太多业务逻辑，该因素可以忽略。</li>
<li>是否需要支持Transaction？ NoSQL不支持Transaction，但是可以在业务层做处理保证。</li>
<li>对QPS要求高不高？<br>NoSQL性能高，MondoDB可以到10k级别，MySQL只能在k这个级别。</li>
<li>对Scalability的要求有多高？sharding，replica。</li>
</ol>
<ul>
<li><p>Number</p>
<p>Average size of longURL = 100 bytes</p>
<p>Average size of shortURL = 4 bytes(int)</p>
<p>State = 4 byte</p>
<p>Daily new URL = 3,000,000 <em> 108 = 324MB =&gt; Yearly new URL = 324</em>365 = 118GB</p>
</li>
<li><p>NoSQL,</p>
<ol>
<li><u>Randomly generate</u> 6 characters containing [A-Z, a-z, 0-9]</li>
<li>Use consistent hashing for partition: Partition By Key Or Consistent Hashing; Vitural nodes; Replication for high avaialbility </li>
<li>Use NoSQL’s distributed key-value store</li>
<li>Eventually consistent: <strong>quorum</strong>; others return checksum(eg. SHA1), if it is same with data -&gt; no need to lookup</li>
<li>Short URL already exists? What to do with conflicts? Retry</li>
</ol>
<ul>
<li>Write Optimization 1<ul>
<li>Use centralized “Counter” to generate unique URL</li>
<li>similar to auto-increment id in SQL</li>
<li>Uniqueness guaranteed</li>
</ul>
</li>
<li>Write Optimization 2<ul>
<li><u>Round robin</u> to different URL generators, each governing a dedicate key space</li>
<li>Partition key spaces such as “AXXXXX”, “BXXXXX” and etc.</li>
<li>Similar to sharding - avoid conflicts</li>
</ul>
</li>
</ul>
</li>
<li><p>SQL, <code>id(primary key), long_url(unique index), created_at</code></p>
<ul>
<li>Map 6 characters containing [A-Z, a-z, 0-9] to an <u>integer</u></li>
<li><a href="http://en.wikipedia.org/wiki/Base_conversion#Base_conversion" target="_blank" rel="external">Base Conversion</a> problem: base 62</li>
<li>More of single machine solution</li>
<li>Schema?</li>
</ul>
</li>
</ul>
</li>
<li><p>Other Factors to Consider</p>
<ol>
<li><p>High availability</p>
</li>
<li><p>How to cache? Preload / Replace</p>
<p>First use sharding(分片，根据region) to partition different regions</p>
<p>You may have China DB and US DB for example</p>
<p>Use <u>redis / memcached LRU cache</u> for <u>repeated</u> query</p>
</li>
<li><p>Reuse popular short urls</p>
<p>Store those popular urls based on clicks.  Use the same short url</p>
</li>
<li><p>Custom URLs</p>
<p>(1) Use another table for custom URLs (SQL), since SQL use id rather than short_url</p>
<ul>
<li><ul>
<li>Need to look up two tables now for read/write</li>
<li>Atomicity not guaranteed in NoSQL</li>
</ul>
</li>
</ul>
<p>(2) Use the same table with additional boolean column (NoSQL), <code>short_url, long_url, created_at, custom(true/false)</code></p>
<ul>
<li><ul>
<li>Same look up, need to query the boolean column</li>
<li>Atomicity still guaranteed</li>
<li>Not working well for SQL solution, which is auto id based</li>
</ul>
</li>
</ul>
</li>
<li><p>Analytics (usage of URLs), eg. referrers, browsers, countires, patforms</p>
</li>
<li><p>Automatic link expiration, add <code>last_read_time</code></p>
</li>
<li><p>Manual link removal</p>
<p>in NoSQL, such in disk, Append only operation is faster, add <code>alive(true/false)</code></p>
</li>
<li><p>UI v.s. API</p>
</li>
<li><p>User’s historical short urls, eg. with account system</p>
</li>
</ol>
</li>
<li><p>SQL index: use B+ tree index primary key, everytime use binary tree to find</p>
<ul>
<li><p>When primary key is declared, DBMS automatically creates unique index</p>
</li>
<li><p>Often need additional indexes</p>
</li>
<li><p>Using CREATE INDEX command, SQL indexes can be created on basis of any selected attribute</p>
</li>
<li><p>Composite index</p>
</li>
<li><ul>
<li>Index based on two or more attributes</li>
<li>Often used to prevent data duplication</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="218-The-Skyline-Problem"><a href="#218-The-Skyline-Problem" class="headerlink" title="218. The Skyline Problem"></a><a href="https://leetcode.com/problems/the-skyline-problem/description/" target="_blank" rel="external">218. The Skyline Problem</a></h4><ul>
<li><p><a href="https://briangordon.github.io/2014/08/the-skyline-problem.html" target="_blank" rel="external">reference</a></p>
</li>
<li><p>OOD</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Building</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Building</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> left;</span><br><span class="line">  <span class="keyword">int</span> right;</span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Building</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.left = left;</span><br><span class="line">	<span class="keyword">this</span>.right = right;</span><br><span class="line">	<span class="keyword">this</span>.height = height;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Building o)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.height != o.height) &#123;</span><br><span class="line">      <span class="keyword">return</span> Integer.compare(<span class="keyword">this</span>.height, o.height);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.left != o.left) &#123;</span><br><span class="line">	  <span class="keyword">return</span> Integer.compare(<span class="keyword">this</span>.left, o.left);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Integer.compare(<span class="keyword">this</span>.right, o.right);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"Building [left="</span> + left + <span class="string">", right="</span> + right + <span class="string">", height="</span> + height + <span class="string">"]"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Other test case</p>
<ul>
<li>what if left meets right (B0[1 5 10], B1[5 9 10], B2[9 12 20], B3[12 1510]) -&gt; enter first, otherwise it will add to result (wrong)</li>
<li>What if start at same and end at same (B0[1 17 3], B1[1 3 8], B2[1 4 2], B3[13 17 8], B4[14 17 2]) -&gt; when compare: if left1=left2, first enter larger height, if right1=right2, first leave smaller height</li>
</ul>
</li>
<li><p>code</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">	    <span class="comment">/**</span><br><span class="line">	     * The Skyline Problem</span><br><span class="line">	     *  city's skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance. Now suppose you are given the locations and height of all the buildings as shown on a cityscape photo (Figure A), write a program to output the skyline formed by these buildings collectively (Figure B).</span><br><span class="line">	     *  The geometric information of each building is represented by a triplet of integers [Li, Ri, Hi], where Li and Ri are the x coordinates of the left and right edge of the ith building, respectively, and Hi is its height. It is guaranteed that 0 鈮� Li, Ri 鈮� INT_MAX, 0 &lt; Hi 鈮� INT_MAX, and Ri - Li &gt; 0. You may assume all buildings are perfect rectangles grounded on an absolutely flat surface at height 0.</span><br><span class="line">For instance, the dimensions of all buildings in Figure A are recorded as: [ [2 9 10], [3 7 15], [5 12 12], [15 20 10], [19 24 8] ] .</span><br><span class="line">The output is a list of "key points" (red dots in Figure B) in the format of [ [x1,y1], [x2, y2], [x3, y3], ... ] that uniquely defines a skyline. A key point is the left endpoint of a horizontal line segment. Note that the last key point, where the rightmost building ends, is merely used to mark the termination of the skyline, and always has zero height. Also, the ground in between any two adjacent buildings should be considered part of the skyline contour.</span><br><span class="line">For instance, the skyline in Figure B should be represented as:[ [2 10], [3 15], [7 12], [12 0], [15 10], [20 8], [24, 0] ].</span><br><span class="line">Notes:</span><br><span class="line">    The number of buildings in any input list is guaranteed to be in the range [0, 10000].</span><br><span class="line">    The input list is already sorted in ascending order by the left x position Li.</span><br><span class="line">    The output list must be sorted by the x position.</span><br><span class="line">    There must be no consecutive horizontal lines of equal height in the output skyline. For instance, [...[2 3], [4 5], [7 5], [11 5], [12 7]...] is not acceptable; the three lines of height 5 should be merged into one in the final output as such: [...[2 3], [4 5], [12 7], ...]</span><br><span class="line">	https://briangordon.github.io/2014/08/the-skyline-problem.html</span><br><span class="line">	     */</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;<span class="keyword">int</span>[]&gt; getSkyline(<span class="keyword">int</span>[][] buildings) &#123;</span><br><span class="line">		<span class="keyword">if</span> (buildings.length == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">		&#125;</span><br><span class="line">		Building[] lefts = <span class="keyword">new</span> Building[buildings.length];</span><br><span class="line">		Building[] rights = <span class="keyword">new</span> Building[buildings.length];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; buildings.length; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span>[] b = buildings[i];</span><br><span class="line">			Building building = <span class="keyword">new</span> Building(b[<span class="number">0</span>], b[<span class="number">1</span>], b[<span class="number">2</span>]);</span><br><span class="line">			rights[i] = lefts[i] = building;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//sort according to left</span></span><br><span class="line">		Arrays.sort(lefts, (a, b) -&gt; &#123;</span><br><span class="line">			<span class="keyword">if</span> (a.left != b.left) &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(a.left, b.left);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> Integer.compare(b.height, a.height);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">//sort according to right</span></span><br><span class="line">		Arrays.sort(rights, (a, b) -&gt; &#123;</span><br><span class="line">			<span class="keyword">if</span> (a.right != b.right) &#123;</span><br><span class="line">				<span class="keyword">return</span> Integer.compare(a.right, b.right);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> Integer.compare(a.height, b.height);</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		System.out.println(Arrays.toString(lefts));</span><br><span class="line">		System.out.println(Arrays.toString(rights));</span><br><span class="line">		List&lt;<span class="keyword">int</span>[]&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		TreeSet&lt;Building&gt; set = <span class="keyword">new</span> TreeSet&lt;&gt;(); <span class="comment">// will use compareTo to compare</span></span><br><span class="line">		<span class="keyword">int</span> leftsIndex = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> rightsIndex = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> h = lefts[<span class="number">0</span>].height; <span class="comment">// max height of buildings in set</span></span><br><span class="line">		<span class="keyword">int</span> top = h; <span class="comment">// last seen h</span></span><br><span class="line">		set.add(lefts[<span class="number">0</span>]);</span><br><span class="line">		result.add(<span class="keyword">new</span> <span class="keyword">int</span>[] &#123; lefts[<span class="number">0</span>].left, top &#125;);</span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (rightsIndex &lt; buildings.length) &#123;</span><br><span class="line">			<span class="keyword">if</span> (leftsIndex == buildings.length || rights[rightsIndex].right &lt; lefts[leftsIndex].left) &#123;</span><br><span class="line">				index = rights[rightsIndex].right;</span><br><span class="line">				System.out.println(<span class="string">"Remove "</span> + rights[rightsIndex]);</span><br><span class="line">				set.remove(rights[rightsIndex++]);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				index = lefts[leftsIndex].left;</span><br><span class="line">				System.out.println(<span class="string">"Add "</span> + lefts[leftsIndex]);</span><br><span class="line">				set.add(lefts[leftsIndex++]);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(set);</span><br><span class="line">			h = set.isEmpty() ? <span class="number">0</span> : set.last().height;</span><br><span class="line">			<span class="keyword">if</span> (h != top) &#123;</span><br><span class="line">				top = h;</span><br><span class="line">				result.add(<span class="keyword">new</span> <span class="keyword">int</span>[] &#123; index, top &#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">/*</span><br><span class="line">sol1: h[mostL...mostR]</span><br><span class="line">sol2:</span><br><span class="line">maintain a PQ &lt;height,end time&gt;</span><br><span class="line">cur = 0,</span><br><span class="line">nexT = PQ top end time;</span><br><span class="line">if cur.begT &gt; next // it ends before others coming</span><br><span class="line">	pop all the buildings in Pq whose enttime &lt;= nextT;</span><br><span class="line">else&#123;</span><br><span class="line">	push all the buildings at the same time,cur++</span><br><span class="line">	nexT = cur.beg</span><br><span class="line">&#125;</span><br><span class="line">//nexT = PQ's heightest building's end time</span><br><span class="line">curH = PQ's heightest or 0;</span><br><span class="line">if != last height </span><br><span class="line">	add curH,nexT</span><br><span class="line"></span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; getSkyline(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; buildings) &#123;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; ans;</span><br><span class="line">    	priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; aliveB;</span><br><span class="line">    	<span class="keyword">int</span> cur = <span class="number">0</span>, nexT = <span class="number">0</span>, curH = <span class="number">0</span>, len = buildings.size();</span><br><span class="line">    	<span class="keyword">while</span> (!aliveB.empty() || (cur&lt;len))&#123;</span><br><span class="line">    		<span class="keyword">if</span> (aliveB.empty())</span><br><span class="line">    			nexT = buildings[cur][<span class="number">0</span>];</span><br><span class="line">    		<span class="keyword">else</span> </span><br><span class="line">    			nexT = aliveB.top().second;</span><br><span class="line">    		<span class="keyword">if</span> ((cur&gt;=len)||(buildings[cur][<span class="number">0</span>]&gt;nexT))</span><br><span class="line">    			<span class="keyword">while</span> (!aliveB.empty() &amp;&amp; aliveB.top().second&lt;= nexT)</span><br><span class="line">    				aliveB.pop();</span><br><span class="line">    		<span class="keyword">else</span>&#123;</span><br><span class="line">    			nexT = buildings[cur][<span class="number">0</span>];</span><br><span class="line">    			<span class="keyword">while</span> ((cur&lt;len)&amp;&amp;(buildings[cur][<span class="number">0</span>]==nexT))&#123;</span><br><span class="line">    				aliveB.push(make_pair(buildings[cur][<span class="number">2</span>],buildings[cur][<span class="number">1</span>]));</span><br><span class="line">    				cur++;</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">if</span> (aliveB.empty())</span><br><span class="line">    			curH = <span class="number">0</span>;</span><br><span class="line">    		<span class="keyword">else</span> </span><br><span class="line">    			curH = aliveB.top().first;</span><br><span class="line">    		<span class="keyword">if</span> ((ans.empty())||(ans.back().second!=curH))</span><br><span class="line">    			ans.push_back(make_pair(nexT, curH));</span><br><span class="line">    	&#125;</span><br><span class="line">    	return ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Interval: <a href="">253. Meeting Rooms II</a></p>
</li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/17/System-Design-II/" itemprop="url">
                  System Design II
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-17T10:52:13-07:00" content="2018-03-17">
              2018-03-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-Design/" itemprop="url" rel="index">
                    <span itemprop="name">System Design</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/17/System-Design-II/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/17/System-Design-II/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/17/System-Design-II/" class="leancloud_visitors" data-flag-title="System Design II">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="Scalability"><a href="#Scalability" class="headerlink" title="Scalability"></a>Scalability</h5><ul>
<li><p>concepts</p>
<ul>
<li>Vertical scaling: CPU(more cores, L2 Cache…), Disk(PATA, SATA, SAS…; RAID), RAM…</li>
<li>Horizontal scaling: get a bunch of slower or at least cheaper machines instand of plural number of machines</li>
<li>Caching</li>
<li>Load balancing: traffic come from people -&gt; distributed or balanced</li>
<li>Database replication<ul>
<li>have master-slave; in case of database dies; if more read heavy &gt; write heavy =&gt; select statements go to server 2,3,4, any inserts, updates or deletes go to go to server 1</li>
<li>have master-master: can write any server; if connection down, you can read from master</li>
</ul>
</li>
<li>Database partitioning</li>
</ul>
<p>​</p>
<ul>
<li>Using NoSQL instead of scaling a relational database</li>
<li>Being asynchronous</li>
<li>how to deal with the two major bottlenecks: handling a lot of users, and handling a lot of data</li>
</ul>
</li>
<li><p>eg.</p>
<ul>
<li><a href="http://highscalability.com/blog/2016/10/12/lessons-learned-from-scaling-uber-to-2000-engineers-1000-ser.html" target="_blank" rel="external">Uber</a>: A nice article about how Uber had to scale fast, about breaking your service into many micro services spread across many repos</li>
<li><a href="http://highscalability.com/blog/2016/6/27/how-facebook-live-streams-to-800000-simultaneous-viewers.html" target="_blank" rel="external">Facebook</a>: How Facebook handles 800,000 simultaneous viewers on a live stream</li>
<li><a href="http://highscalability.com/blog/2016/4/20/how-twitter-handles-3000-images-per-second.html" target="_blank" rel="external">Twitter</a>: How Twitter handles 3,000 image uploads per second and why the old ways it used would not work nowadays.  Twitter subcomponents: Storing data (<a href="http://www.youtube.com/watch?v=5cKTP36HVgI" target="_blank" rel="external">video</a> | <a href="http://highscalability.com/blog/2011/12/19/how-twitter-stores-250-million-tweets-a-day-using-mysql.html" target="_blank" rel="external">text</a>), and Timeline (<a href="http://www.infoq.com/presentations/Twitter-Timeline-Scalability" target="_blank" rel="external">video</a> | <a href="http://highscalability.com/blog/2013/7/8/the-architecture-twitter-uses-to-deal-with-150m-active-users.html" target="_blank" rel="external">text</a>).</li>
<li><a href="http://highscalability.com/blog/2013/9/23/salesforce-architecture-how-they-handle-13-billion-transacti.html" target="_blank" rel="external">Salesforce</a>: A relatively short example from Salesforce.</li>
<li><a href="http://highscalability.com/google-architecture" target="_blank" rel="external">Google</a>, Youtube (<a href="http://www.youtube.com/watch?v=w5WVu624fY8" target="_blank" rel="external">video</a> | <a href="http://highscalability.com/youtube-architecture" target="_blank" rel="external">text</a>), <a href="http://highscalability.com/blog/2012/2/13/tumblr-architecture-15-billion-page-views-a-month-and-harder.html" target="_blank" rel="external">Tumblr</a>, <a href="http://highscalability.com/blog/2009/8/5/stack-overflow-architecture.html" target="_blank" rel="external">StackOverflow</a>, and <a href="http://highscalability.com/blog/2011/11/29/datasift-architecture-realtime-datamining-at-120000-tweets-p.html" target="_blank" rel="external">Datashift</a>.</li>
</ul>
</li>
<li><p>Warp-up</p>
<p>You first build a high-level architecture by identifying the constraints and use cases, sketching up the major components and the relationships between them, and thinking about the system’s bottlenecks. You then apply the right scalability patterns that will take care of these bottlenecks in the context of the system’s constraints.</p>
<ul>
<li><p>eg. Scalable design</p>
<ol>
<li><p>Application Service layer</p>
<ul>
<li>Start with one machine</li>
<li>Measure how far it takes us (load tests)</li>
<li>Add a load balance + a cluster of machines over time: to deal with spike-y traffic, to increase availability</li>
</ul>
</li>
<li><p>Data storage</p>
<p>1) Billions of objects</p>
<p>2) Each object is fairly smaill(&lt;1K)</p>
<p>3) There are no relationships between the objects</p>
<p>4) Reads are 9x more frequent than writes (360 reads, 40 writes per second)</p>
<p>5) 3TBs of urls, 36GB of hases</p>
<p>MySQL:</p>
<ul>
<li>Widely used</li>
<li>Mature technology</li>
<li>Clear acling paradigms(sharding, master/slave replication, master/master replication)</li>
<li>Used by Facebook, Twitter, Google, etc.</li>
<li>Index lookups are very fast</li>
</ul>
<p>mappings</p>
<ul>
<li>hash: varchar(6)</li>
<li>original_url: varchar(512)</li>
</ul>
<p>1) Create a uniquue index on the hash(36GB+). We want to hold it in memory.</p>
<p>2) Option 1: Vertival sacling of the MySQL machine</p>
<p>3) Option 2: Partition the data: 5 partitions, 600GB of data, 8GB of indexes</p>
<p>4) Master-slave (reading from the slaves, writes to the master)</p>
<p>=&gt; </p>
<ol>
<li>Use one MySQL table with two varchar fields</li>
<li>Create a uniquue index on the hash(36GB+). We want to hold it in memory to speed up lookups.</li>
<li>Vertival sacling of the MySQL machine for a while</li>
<li>Eventually, partition the data by taking the first chr of the hash mod the number of partitions. Thinks about a master-slave setup. </li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
<li><p>Example: <a href="https://www.hiredintech.com/classrooms/system-design/lesson/67" target="_blank" rel="external">The Twitter Problem</a>, <a href="https://www.hiredintech.com/classrooms/system-design/lesson/101" target="_blank" rel="external">The Summarization Problem</a></p>
</li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/11/LeetCode-Anagrams/" itemprop="url">
                  LeetCode | Anagrams
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-11T23:52:18-07:00" content="2018-03-11">
              2018-03-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/11/LeetCode-Anagrams/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/11/LeetCode-Anagrams/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/11/LeetCode-Anagrams/" class="leancloud_visitors" data-flag-title="LeetCode | Anagrams">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Anagrams"><a href="#Anagrams" class="headerlink" title="Anagrams"></a>Anagrams</h4><h5 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h5><ul>
<li><p><a href="https://leetcode.com/problems/valid-anagram/description/" target="_blank" rel="external">242. Valid Anagram</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isAnagram</span><span class="params">(<span class="built_in">string</span> s, <span class="built_in">string</span> t)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> l1=s.length();</span><br><span class="line">    	<span class="keyword">if</span> (l1!=t.length())</span><br><span class="line">    		return <span class="literal">false</span>;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cnt(<span class="number">256</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">char</span> ch:s)</span><br><span class="line">    		cnt[ch]++;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">char</span> ch:t)&#123;</span><br><span class="line">    		cnt[ch]--;</span><br><span class="line">    		<span class="keyword">if</span> (cnt[ch]&lt;<span class="number">0</span>)</span><br><span class="line">    			return <span class="literal">false</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	return <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/group-anagrams/description/" target="_blank" rel="external">49. Group Anagrams</a></p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use sort &amp; hashmap</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&gt; groupAnagrams(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; strs) &#123;</span><br><span class="line">  <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="built_in">multiset</span>&lt;<span class="built_in">string</span>&gt;&gt; ansmap;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> s:strs)&#123;</span><br><span class="line">    <span class="built_in">string</span> tmp = s;</span><br><span class="line">    sort(tmp.begin(),tmp.end());</span><br><span class="line">    ansmap[tmp].insert(s);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&gt; ans;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> str:ansmap)&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; anstmp(str.second.begin(),str.second.end());</span><br><span class="line">    ans.push_back(anstmp);</span><br><span class="line">  &#125;</span><br><span class="line">  return ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use primer to present number</span></span><br><span class="line"><span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; groupAnagrams(String[] strs) &#123;</span><br><span class="line">  <span class="keyword">int</span>[] prime = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>&#125;;</span><br><span class="line">  List&lt;List&lt;String&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  HashMap&lt;Integer, Integer&gt; map= <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (String s : strs)&#123;</span><br><span class="line">    <span class="keyword">int</span> key = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c : s.toCharArray())</span><br><span class="line">      key *= prime[c-<span class="string">'a'</span>];</span><br><span class="line">    <span class="comment">//use index as value</span></span><br><span class="line">    List&lt;String&gt; tmp;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(key))</span><br><span class="line">      tmp = res.get(map.get(key));</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      tmp = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      map.put(key, res.size());</span><br><span class="line">      res.add(tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    tmp.add(s);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><a href="https://leetcode.com/problems/find-all-anagrams-in-a-string/description/" target="_blank" rel="external">438. Find All Anagrams in a String</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sliding window</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; findAnagrams(<span class="built_in">string</span> s, <span class="built_in">string</span> p) &#123;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ch1(<span class="number">26</span>,<span class="number">0</span>), ch2(<span class="number">26</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">int</span> l1 = s.length(), l2 = p.length();</span><br><span class="line">    	<span class="keyword">if</span> (l1&lt;l2)</span><br><span class="line">    		return ans;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;l2;i++)&#123;</span><br><span class="line">    		ch1[s[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    		ch2[p[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span> (ch1==ch2)</span><br><span class="line">    		ans.push_back(<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=l2;i&lt;l1;i++)&#123;</span><br><span class="line">    		ch1[s[i-l2]-<span class="string">'a'</span>]--;</span><br><span class="line">    		ch1[s[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    		<span class="keyword">if</span> (ch1==ch2)</span><br><span class="line">    			ans.push_back(i-l2+<span class="number">1</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    	return ans;    </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findAnagrams</span><span class="params">(String s, String p)</span> </span>&#123;</span><br><span class="line">  List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">if</span> (s == <span class="keyword">null</span> || s.length() == <span class="number">0</span> || p == <span class="keyword">null</span> || p.length() == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  <span class="keyword">int</span>[] les = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">char</span> c : p.toCharArray())</span><br><span class="line">    ++ les[c];</span><br><span class="line">  <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>, cnt = p.length();</span><br><span class="line">  <span class="keyword">int</span> len1 = p.length(), len2 = s.length();</span><br><span class="line">  <span class="keyword">while</span> (r &lt; len2)&#123;</span><br><span class="line">    <span class="comment">// right letter s[r] exist in p that has been matched</span></span><br><span class="line">    <span class="keyword">if</span> (les[s.charAt(r++)]-- &gt;= <span class="number">1</span>)</span><br><span class="line">      -- cnt;</span><br><span class="line">    <span class="keyword">if</span> (cnt == <span class="number">0</span>)</span><br><span class="line">      res.add(l);</span><br><span class="line">    <span class="comment">// left letter s[l] exist in p that shoule be matched letter</span></span><br><span class="line">    <span class="keyword">if</span> (r - l == len1 &amp;&amp; les[s.charAt(l++)]++ &gt;= <span class="number">0</span>) cnt++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://leetcode.com/problems/permutation-in-string/description/" target="_blank" rel="external">567. Permutation in String</a></p>
<p>the first string’s permutations is the <strong>substring</strong> of the second string -&gt; find anagram </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Silimar to 567</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">checkInclusion</span><span class="params">(<span class="built_in">string</span> p, <span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ch1(<span class="number">26</span>,<span class="number">0</span>), ch2(<span class="number">26</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">int</span> l1 = s.length(), l2 = p.length();</span><br><span class="line">    	<span class="keyword">if</span> (l1&lt;l2)</span><br><span class="line">    		return <span class="literal">false</span>;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;l2;i++)&#123;</span><br><span class="line">    		ch1[s[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    		ch2[p[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span> (ch1==ch2)</span><br><span class="line">            return <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i=l2;i&lt;l1;i++)&#123;</span><br><span class="line">    		ch1[s[i-l2]-<span class="string">'a'</span>]--;</span><br><span class="line">    		ch1[s[i]-<span class="string">'a'</span>]++;</span><br><span class="line">    		<span class="keyword">if</span> (ch1==ch2)</span><br><span class="line">    			return <span class="literal">true</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	return <span class="literal">false</span>;           </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> [] les = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">char</span> c : s1.toCharArray())</span><br><span class="line">    ++ les[c];</span><br><span class="line">  <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>, cnt = s1.length();</span><br><span class="line">  <span class="keyword">int</span> len1 = s1.length(), len2 = s2.length();</span><br><span class="line">  <span class="keyword">while</span> (r &lt; len2)&#123;</span><br><span class="line">    <span class="comment">// right letter s[r] exist in p that has been matched</span></span><br><span class="line">    <span class="keyword">if</span> (les[s2.charAt(r++)]-- &gt;= <span class="number">1</span>)</span><br><span class="line">      -- cnt;</span><br><span class="line">    <span class="keyword">if</span> (cnt == <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="comment">// left letter s[l] exist in p that shoule be matched letter</span></span><br><span class="line">    <span class="keyword">if</span> (r - l == len1 &amp;&amp; les[s2.charAt(l++)]++ &gt;= <span class="number">0</span>) cnt++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h5><p>Normally it is related to <code>HashMap</code>, <code>sort</code>, <code>two pointer</code></p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/06/System-Design-I/" itemprop="url">
                  System Design I
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-06T21:10:16-08:00" content="2018-03-06">
              2018-03-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/System-Design/" itemprop="url" rel="index">
                    <span itemprop="name">System Design</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/06/System-Design-I/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/06/System-Design-I/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/06/System-Design-I/" class="leancloud_visitors" data-flag-title="System Design I">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="System-Design-I"><a href="#System-Design-I" class="headerlink" title="System Design I"></a>System Design I</h4><ul>
<li><a href="http://www.hiredintech.com/system-design/" target="_blank" rel="external">reference</a></li>
</ul>
<p>eg. Design a url shortening service, like bit.ly</p>
<h5 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h5><ul>
<li><p>Step 1: [<strong>Scope</strong> the problem]</p>
<ul>
<li><p>Use Cases </p>
<ol>
<li>Shortening: take a url =&gt; return a shorter url</li>
<li>Redirection: take a short url =&gt; redirect to the original url</li>
<li>Custom url: allow users to pick their available shortened URL</li>
<li><p>High availability of the system</p>
<p>Others:</p>
</li>
<li><p>Analytics: to look at usage statistics </p>
</li>
<li>Automatic link expiration: automatically expire link or stay alive forever </li>
<li>Manual link removal: the user wants to remove the link</li>
<li>UI vs API: design a web service or a website, or a URL shortening API</li>
</ol>
</li>
<li><p>Constraints</p>
<ul>
<li>the amount of traffic &amp; data: how many the requests a mouth should handle and how many new URLs per month should the site handle =&gt; per second</li>
<li>approcimation eg. active users: Facebook, 1.3billion; Twitter, 650 million, new tweets made per day, 500 million</li>
</ul>
<ol>
<li><p>=&gt; 1.5BN new tweets =&gt; All shortened URL per month 1.5BN =&gt; Site below the top 3: shorten 300M per monty =&gt; We: 100M new urls per month</p>
</li>
<li><p>assume average lifetime: 1-2 weeks ~ 10 days</p>
<p>&amp; assume 1 click per day,</p>
<p>&amp;  20% got much more traffic than the rest 80% =&gt; 100 mln <em> 10 days </em> 1 click per day = 1 BN requests per month =&gt; 400+ requests per second</p>
</li>
<li><p>10% from shortening, 90% from redirection =&gt; 40 shortens, 360 redirections</p>
</li>
<li><p>Total urls: 5 years X 12 months X 100M = 6 BN url </p>
</li>
<li><p>500 bytes per URL =&gt; total storage of urls over 5 yrs: 6BN  X 500 bytes = 3TB</p>
</li>
<li><p>log(62,6BN) =&gt; 6 bytes per hash =&gt; hases: 6BN X 6 bytes = 36GB</p>
</li>
<li><p>New data written per second: 40 X (500+6) = 12K</p>
</li>
<li><p>Data read per second: 360 X (500+6) = 180K </p>
</li>
</ol>
<p>=&gt; <a href="https://raw.githubusercontent.com/antonrd/hiredintech_files/master/system_design/digram_url_shortening.jpg" target="_blank" rel="external">pic</a></p>
</li>
</ul>
</li>
<li><p>Step 2: [Sketch up an] <strong>Abstract design</strong></p>
<p>sketch the important components and the connections between them</p>
<ol>
<li>Aplication Design<ol>
<li>Shortening service: generate on your hash; check if it’s in the datastore, not -&gt; store a new mapping, or -&gt; generate new hash …</li>
<li>Redirection service:</li>
<li>Custom URL: take a hash from user, check if it’s a shorten URL word, check if it’s in the datastore, not -&gt; store, or -&gt; return a message</li>
</ol>
</li>
<li>Data storage layer (keep track of the hash =&gt; url mappings)<ol>
<li>Acts like a hash table: stores new mappings and retrieve a value given a key</li>
</ol>
</li>
</ol>
<p>hashed_url = convert_to_base62(md5(original_url + random_salt))[:6]</p>
</li>
<li><p>Step 3: [Think about the] <strong>bottlenecks</strong></p>
<p>eg. Perhaps your system needs a load balancer and many machines behind it to handle the user requests. Or maybe the data is so huge that you need to distribute your database on multiple machines. What are some of the downsides that occur from doing that? Is the database too slow and does it need some in-memory caching?</p>
<ol>
<li>traffic: not very challenging since it’s lightweight; think how we quickly look up URL</li>
<li>lots of data</li>
</ol>
</li>
<li><p>Step 4: [Address these bottlenecks by  using the fundamentals principles of <strong>scalable system design</strong>] Scaling your abstract design</p>
</li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/20/571-Web-Technologies-Review/" itemprop="url">
                  571 Web Technologies Review
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-02-20T23:03:16-08:00" content="2018-02-20">
              2018-02-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Course/" itemprop="url" rel="index">
                    <span itemprop="name">Course</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/02/20/571-Web-Technologies-Review/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/02/20/571-Web-Technologies-Review/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/02/20/571-Web-Technologies-Review/" class="leancloud_visitors" data-flag-title="571 Web Technologies Review">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Midterm-Review"><a href="#Midterm-Review" class="headerlink" title="Midterm Review"></a>Midterm Review</h3><ul>
<li><a href="https://github.com/ZoeyeoZ/USC_Projects/blob/master/571/571%20Midterm%201.pdf" target="_blank" rel="external">571 Midterm 1</a></li>
<li><a href="https://github.com/ZoeyeoZ/USC_Projects/blob/master/571/571%20Midterm%202.pdf" target="_blank" rel="external">571 Midterm 2</a></li>
<li><a href="https://github.com/ZoeyeoZ/USC_Projects/blob/master/571/571%20Midterm%203.pdf" target="_blank" rel="external">571 Midterm 3</a></li>
<li><a href="https://github.com/ZoeyeoZ/USC_Projects/blob/master/571/571%20midterm.pdf" target="_blank" rel="external">571 Midterm</a></li>
</ul>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/10/X3-Binary-Search/" itemprop="url">
                  X3_Binary Search
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-02-10T22:56:06-08:00" content="2018-02-10">
              2018-02-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index">
                    <span itemprop="name">Program</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Program/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/02/10/X3-Binary-Search/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/02/10/X3-Binary-Search/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/02/10/X3-Binary-Search/" class="leancloud_visitors" data-flag-title="X3_Binary Search">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Binary-Tree-Level-Order-Traversal"><a href="#Binary-Tree-Level-Order-Traversal" class="headerlink" title="Binary Tree Level Order Traversal"></a>Binary Tree Level Order Traversal</h4><p>test case:cover different + corner case</p>
<ol>
<li>only left/right child</li>
<li>full tree</li>
<li>left child, right child, left child, right child…</li>
</ol>
<p>Follow Up: output the level to level reversely from bottom to up</p>
<ol>
<li>reverse funtion</li>
<li>add from front</li>
</ol>
<h4 id="Intersection-of-Two-Arrays"><a href="#Intersection-of-Two-Arrays" class="headerlink" title="Intersection of Two Arrays"></a>Intersection of Two Arrays</h4><ol>
<li>If non sort-&gt; Hashmap. Ues extra space. O(m+n)</li>
<li>If sort-&gt; Two pointers. O(m+n)</li>
<li>If no extra space / If n&gt;&gt;m, scan the smaller array and find it in larger one via binary search in -&gt; If already sort -&gt; O(m*logn)</li>
</ol>
<p>Intersection of k arrays? merge 的变种</p>
<ol>
<li>​</li>
</ol>
<h4 id="Dot-Production-FB"><a href="#Dot-Production-FB" class="headerlink" title="Dot Production (FB)"></a>Dot Production (FB)</h4><p>Conduct Dot Product of two large sparse Vectors</p>
<ol>
<li>find non-zero indexes</li>
<li>intersection</li>
<li>dot product</li>
</ol>
<h4 id="Find-K-th-Smallest-Pair-Distance"><a href="#Find-K-th-Smallest-Pair-Distance" class="headerlink" title="Find K-th Smallest Pair Distance"></a>Find K-th Smallest Pair Distance</h4><ol>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> lo = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> hi = nums[num.length - <span class="number">1</span>] - nums[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">while</span> (lo &lt; hi)&#123;</span><br><span class="line">  <span class="keyword">int</span> mid = lo + ((hi - lo) &gt;&gt;&gt; <span class="number">1</span>);</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// count function = number of pairs with distance &lt;= guess</span></span><br><span class="line"><span class="keyword">if</span> (nums[right] - nums[left] &gt; guess)</span><br><span class="line">  <span class="keyword">continue</span>;</span><br><span class="line">count += right - left;</span><br></pre></td></tr></table></figure>
<p>Runtime: <em>N</em>^2*logW</p>
</li>
<li><p>Optimization</p>
<p>since there may be duplicate -&gt; </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">right = upperBound(nums, left+<span class="number">1</span>, n-<span class="number">1</span>, target);</span><br><span class="line">count += right - left -<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Optimization II</p>
<p>Use Map<integer, integer=""> to memorize</integer,></p>
<p>Binary Search -&gt; N <em>log</em>N * <em>log</em>W</p>
</li>
</ol>
<h4 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h4><h5 id="410-Split-Array-Largest-Sum"><a href="#410-Split-Array-Largest-Sum" class="headerlink" title="410. Split Array Largest Sum"></a><a href="https://leetcode.com/problems/split-array-largest-sum/description/" target="_blank" rel="external">410. Split Array Largest Sum</a></h5><h5 id="Copy-Books-The-Painter’s-Partition-Problem-Part-II"><a href="#Copy-Books-The-Painter’s-Partition-Problem-Part-II" class="headerlink" title="Copy Books, The Painter’s Partition Problem Part II"></a>Copy Books, <a href="http://articles.leetcode.com/2011/04/the-painters-partition-problem-part-ii.html" target="_blank" rel="external">The Painter’s Partition Problem Part II</a></h5><h5 id="expire-map"><a href="#expire-map" class="headerlink" title="expire map"></a>expire map</h5><p><a href="https://www.quora.com/How-can-I-implement-expiry-key-hashmap-in-Java" target="_blank" rel="external">https://www.quora.com/How-can-I-implement-expiry-key-hashmap-in-Java</a></p>
<p>cannot remove element while using for loop, but can use interator</p>
<p><a href="https://stackoverflow.com/questions/6092642/how-to-remove-a-key-from-hashmap-while-iterating-over-it" target="_blank" rel="external">https://stackoverflow.com/questions/6092642/how-to-remove-a-key-from-hashmap-while-iterating-over-it</a></p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExpiringKey</span> <span class="title">implement</span> <span class="title">Comparable</span>&lt;<span class="title">ExpiringKey</span>&gt; </span>&#123;</span><br><span class="line">        V val;</span><br><span class="line">        <span class="keyword">long</span> expirationTime; <span class="comment">// ttl</span></span><br><span class="line">        K k;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ExpringMap</span> </span>&#123;</span><br><span class="line">        Map&lt;K, ExpiringKey&gt; m = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="function">PriorityQueue q</span><br><span class="line">        </span><br><span class="line">        V <span class="title">get</span><span class="params">(Key k)</span> </span>&#123;</span><br><span class="line">            ExpiringKey v = <span class="keyword">this</span>.m.get(k);</span><br><span class="line">            <span class="keyword">if</span> (v == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (v.expirationTime &lt; System.currentTimeMillis()) &#123;</span><br><span class="line">                m.remove(k);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> v.val;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(Key k, V val, <span class="keyword">long</span> expirationTime)</span> </span>&#123;</span><br><span class="line">            ExpiringKey expiringKey = <span class="keyword">new</span> ExpiringKey(val, expirationTime);</span><br><span class="line">            <span class="keyword">this</span>.m.put(k, expiringKey);</span><br><span class="line">            <span class="keyword">this</span>.q.add(expiringKey); <span class="comment">// log(k)</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">cleanup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// q.poll() log(k)</span></span><br><span class="line">            List&lt;K&gt; keys = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (ExpiringKey entry : <span class="keyword">this</span>.m.entrySet()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (entry.getValue().expirationTime &lt; System.currentTimeMillis()) &#123;</span><br><span class="line">                    keys.add(entry.getKey());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (K key : keys) <span class="comment">// delete</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// PriorityQueue&lt;&gt;()   minHeap</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>optimization: use PriorityQueue</p>
<h4 id="Trick"><a href="#Trick" class="headerlink" title="Trick"></a>Trick</h4><ol>
<li><p>search</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// search in java, return index</span></span><br><span class="line"><span class="keyword">if</span> (index&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">  set.add(num);</span><br><span class="line">  l = index;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  index = -(index+<span class="number">1</span>); <span class="comment">//next one who is larger than it</span></span><br><span class="line">  <span class="keyword">if</span> (index &gt;= r)</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  l = index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Difference between &gt;&gt;&gt; and &gt;&gt;</p>
<p><code>&gt;&gt;&gt;</code>  is unsigned</p>
</li>
</ol>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.JPG"
               alt="Zoey HAN" />
          <p class="site-author-name" itemprop="name">Zoey HAN</p>
          <p class="site-description motion-element" itemprop="description">CS | Web | Write | Music</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ZoeyeoZ" target="_blank" title="GitHub">
                  
                    <i class="fa fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/5139990830" target="_blank" title="Weibo">
                  
                    <i class="fa fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/zoey.hz" target="_blank" title="facebook">
                  
                    <i class="fa fa-facebook"></i>
                  
                  facebook
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/zoeyyeoz" target="_blank" title="csdn">
                  
                    <i class="fa fa-book"></i>
                  
                  csdn
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zoey HAN</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ZoeyeoZ"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("T1GdtjiH3C4zaGGuAfBXLIU9-gzGzoHsz", "E1lU2mO5DS4clhzdUCD45SXs");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
